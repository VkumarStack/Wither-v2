import React from "react";
import '../Stylesheets/headerbar.css';
import Register from "./Register";
import SearchBar from './SearchBar';
import SignIn from './SignIn';
import CreatePost from "./CreatePost";

class HeaderBar extends React.Component {
    render() {
        console.log(GetUserUrl())
        if (sessionStorage.getItem("token") === null)
            return (
                <div className="HeaderBar">
                    <div className="logo-title">
                        <svg xmlns="http://www.w3.org/2000/svg" version="1.0" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet">
                            <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" stroke="none">
                            <path d="M1836 5104 c-370 -67 -685 -305 -912 -691 -115 -194 -177 -364 -239 -649 -4 -19 -14 -22 -92 -27 -115 -8 -199 -30 -300 -78 -72 -34 -232 -144 -248 -169 -5 -9 176 -211 196 -218 5 -2 30 14 56 36 27 22 73 54 103 70 58 33 176 65 216 60 l23 -3 5 -225 c2 -124 11 -280 20 -348 67 -510 240 -1087 510 -1694 31 -70 56 -129 56 -131 0 -2 -37 7 -81 20 -327 94 -703 -32 -910 -305 -44 -58 -175 -299 -167 -307 19 -18 460 -221 513 -236 101 -30 287 -37 394 -15 177 36 308 104 437 228 l81 78 38 -72 c29 -55 162 -294 202 -360 5 -9 253 141 253 153 0 5 -37 73 -82 151 -116 203 -339 648 -442 883 -204 462 -362 915 -434 1246 l-19 87 46 6 c95 12 229 -23 307 -83 l50 -38 113 96 113 96 -61 56 c-123 114 -286 171 -493 171 l-127 0 -8 77 c-15 140 -9 505 11 636 61 407 206 719 433 936 254 242 555 331 829 245 127 -41 235 -118 340 -245 l53 -63 -46 -56 c-144 -176 -173 -434 -72 -633 17 -35 61 -115 97 -178 l64 -114 209 -945 c115 -520 209 -948 209 -950 0 -10 235 300 306 405 l77 111 63 -48 c203 -155 475 -257 734 -272 l45 -3 46 92 c48 96 87 208 116 333 13 56 17 122 17 263 l1 187 81 0 c66 0 478 35 507 43 4 1 -304 307 -686 679 l-694 676 -83 148 c-45 82 -100 172 -122 201 -107 140 -318 234 -493 219 -38 -3 -80 -9 -91 -12 -18 -5 -28 3 -54 42 -232 336 -628 508 -1014 438z m1311 -794 c77 -34 106 -66 186 -212 l37 -66 -247 -137 c-137 -76 -251 -139 -255 -142 -4 -2 -32 44 -64 103 -47 87 -57 117 -61 168 -7 84 16 151 73 214 88 99 211 125 331 72z m903 -1010 l335 -331 -110 5 c-359 18 -767 167 -1062 389 -100 75 -166 138 -156 147 4 5 116 69 248 143 l240 134 85 -78 c47 -43 236 -228 420 -409z m-701 -374 c61 -31 111 -59 111 -62 0 -2 -18 -59 -41 -127 -46 -139 -175 -415 -188 -401 -6 7 -171 734 -171 756 0 4 40 -19 89 -51 49 -32 139 -84 200 -115z m695 -226 c66 -11 121 -22 123 -24 9 -9 23 -130 23 -206 0 -149 -44 -350 -76 -350 -32 0 -200 62 -264 97 -72 39 -183 118 -218 156 l-23 24 40 99 c22 54 52 138 67 185 l27 86 91 -24 c50 -12 145 -32 210 -43z m-2954 -1938 c71 -25 160 -70 160 -81 0 -13 -80 -83 -136 -119 -28 -17 -77 -41 -110 -53 -75 -27 -230 -36 -305 -19 -58 13 -209 78 -209 90 0 19 126 122 182 149 126 62 296 76 418 33z"/>
                            <path d="M2775 954 c-102 -23 -199 -66 -324 -145 l-110 -70 36 -57 c156 -245 247 -374 304 -430 113 -112 236 -182 394 -225 65 -18 106 -21 220 -21 122 1 151 4 230 28 133 40 382 182 371 211 -9 24 -228 359 -264 405 -109 137 -262 238 -438 291 -94 29 -319 35 -419 13z m325 -299 c81 -21 172 -70 230 -122 46 -42 150 -175 150 -193 0 -13 -86 -32 -165 -37 -146 -9 -293 43 -403 143 -61 55 -150 179 -138 192 30 30 235 41 326 17z"/>
                            </g>
                        </svg>
                        <h1> <a href={window.location.origin}> Wither </a> </h1>
                    </div>
                    <SearchBar/>
                    <div className="user-buttons">
                        <SignIn/>
                        <Register/>
                    </div>
                </div>
            );
        else 
            return (
                <div className="HeaderBar">
                    <div className="logo-title">
                        <svg xmlns="http://www.w3.org/2000/svg" version="1.0" viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet">
                            <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" stroke="none">
                            <path d="M1836 5104 c-370 -67 -685 -305 -912 -691 -115 -194 -177 -364 -239 -649 -4 -19 -14 -22 -92 -27 -115 -8 -199 -30 -300 -78 -72 -34 -232 -144 -248 -169 -5 -9 176 -211 196 -218 5 -2 30 14 56 36 27 22 73 54 103 70 58 33 176 65 216 60 l23 -3 5 -225 c2 -124 11 -280 20 -348 67 -510 240 -1087 510 -1694 31 -70 56 -129 56 -131 0 -2 -37 7 -81 20 -327 94 -703 -32 -910 -305 -44 -58 -175 -299 -167 -307 19 -18 460 -221 513 -236 101 -30 287 -37 394 -15 177 36 308 104 437 228 l81 78 38 -72 c29 -55 162 -294 202 -360 5 -9 253 141 253 153 0 5 -37 73 -82 151 -116 203 -339 648 -442 883 -204 462 -362 915 -434 1246 l-19 87 46 6 c95 12 229 -23 307 -83 l50 -38 113 96 113 96 -61 56 c-123 114 -286 171 -493 171 l-127 0 -8 77 c-15 140 -9 505 11 636 61 407 206 719 433 936 254 242 555 331 829 245 127 -41 235 -118 340 -245 l53 -63 -46 -56 c-144 -176 -173 -434 -72 -633 17 -35 61 -115 97 -178 l64 -114 209 -945 c115 -520 209 -948 209 -950 0 -10 235 300 306 405 l77 111 63 -48 c203 -155 475 -257 734 -272 l45 -3 46 92 c48 96 87 208 116 333 13 56 17 122 17 263 l1 187 81 0 c66 0 478 35 507 43 4 1 -304 307 -686 679 l-694 676 -83 148 c-45 82 -100 172 -122 201 -107 140 -318 234 -493 219 -38 -3 -80 -9 -91 -12 -18 -5 -28 3 -54 42 -232 336 -628 508 -1014 438z m1311 -794 c77 -34 106 -66 186 -212 l37 -66 -247 -137 c-137 -76 -251 -139 -255 -142 -4 -2 -32 44 -64 103 -47 87 -57 117 -61 168 -7 84 16 151 73 214 88 99 211 125 331 72z m903 -1010 l335 -331 -110 5 c-359 18 -767 167 -1062 389 -100 75 -166 138 -156 147 4 5 116 69 248 143 l240 134 85 -78 c47 -43 236 -228 420 -409z m-701 -374 c61 -31 111 -59 111 -62 0 -2 -18 -59 -41 -127 -46 -139 -175 -415 -188 -401 -6 7 -171 734 -171 756 0 4 40 -19 89 -51 49 -32 139 -84 200 -115z m695 -226 c66 -11 121 -22 123 -24 9 -9 23 -130 23 -206 0 -149 -44 -350 -76 -350 -32 0 -200 62 -264 97 -72 39 -183 118 -218 156 l-23 24 40 99 c22 54 52 138 67 185 l27 86 91 -24 c50 -12 145 -32 210 -43z m-2954 -1938 c71 -25 160 -70 160 -81 0 -13 -80 -83 -136 -119 -28 -17 -77 -41 -110 -53 -75 -27 -230 -36 -305 -19 -58 13 -209 78 -209 90 0 19 126 122 182 149 126 62 296 76 418 33z"/>
                            <path d="M2775 954 c-102 -23 -199 -66 -324 -145 l-110 -70 36 -57 c156 -245 247 -374 304 -430 113 -112 236 -182 394 -225 65 -18 106 -21 220 -21 122 1 151 4 230 28 133 40 382 182 371 211 -9 24 -228 359 -264 405 -109 137 -262 238 -438 291 -94 29 -319 35 -419 13z m325 -299 c81 -21 172 -70 230 -122 46 -42 150 -175 150 -193 0 -13 -86 -32 -165 -37 -146 -9 -293 43 -403 143 -61 55 -150 179 -138 192 30 30 235 41 326 17z"/>
                            </g>
                        </svg>
                        <h1> <a href={window.location.origin}> Wither </a> </h1>
                    </div>
                    <SearchBar/>
                    <div className="user-buttons">
                        { (GetUserUrl() !== sessionStorage.getItem("user")) && 
                            <YourProfile/>
                        }
                        <Logout/>
                    </div>
                </div>
            )
    }
}

function GetUserUrl() {
    let path = window.location.pathname.split("/");
    if(path.length > 2)
        return path[2] // First element in array is empty string, then "users", and then third should be the username
    else
        return null
}


function YourProfile(props) {
    let user = sessionStorage.getItem("user")
    return (
        <div className="YourProfile">
            <div className="profile-button button"
            onClick={() => {
                window.location.replace(`/users/${user}`);
            }}>
                Profile       
            </div>
        </div>
    );
}

function Logout(props) {
    return (
        <div className="Logout">
            <div className="logout-button button"
            onClick={() => {
                sessionStorage.clear();
                window.location.reload(true);
            }}>
                Logout       
            </div>
        </div>
    );
}

export default HeaderBar;